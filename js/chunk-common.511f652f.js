(self["webpackChunkminecraft_perf_viewer"]=self["webpackChunkminecraft_perf_viewer"]||[]).push([[64],{66350:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n(83673);const l={ref:"plotContainerRef"};function a(e,t,n,a,i,o){const s=(0,r.up)("q-resize-observer");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(s,{onResize:e.updatePlot},null,8,["onResize"]),(0,r._)("div",l,null,512)])}var i=n(96601),o=n(35880),s=n(48825),p=n(61959),c=n(33954),u=n(40019);const d=(0,r.aZ)({name:"EntitiesChart",props:{csvData:{type:String,required:!0},groupBy:{type:String}},setup(e){const t=(0,p.iH)(null),n=(0,s.Z)(),l=(0,c.useStore)(),a=(0,r.Fl)((()=>l.state.perfViewer.highlightTypes)),d=()=>{var r,l,s,p,c;const d=null!==(r=e.groupBy)&&void 0!==r?r:"display_name";if(t.value){const r=e.csvData,b=(0,i.ueB)(r);for(var f=new Map,h=0;h<b.length;h++){var v=b[h];const e=null!==(l=v[d])&&void 0!==l?l:"unknown";var m=f.get(e);m||(m={x:[],y:[],type:null!==(s=v["type"])&&void 0!==s?s:"unknown"},f.set(e,m)),m.x.push(null!==(p=v["x"])&&void 0!==p?p:""),m.y.push(null!==(c=v["z"])&&void 0!==c?c:"")}var g=new Map;f.forEach((function(e,t){const n=!(0!==a.value.length&&!a.value.includes(e.type))||"legendonly";var r=g.get([e.type,t]);r||(r=[],g.set([e.type,t],r)),r.push({x:e.x,y:e.y,mode:"markers",type:"scattergl",name:t,marker:{size:10},visible:n})}));var y=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});const D=[...g].sort((function([[e,t],n],[[r,l],a]){if("minecraft:player"===e)return-1;if("minecraft:player"===r)return 1;var i=y.compare(e,r);return 0!==i?i:y.compare(t,l)})).map((([,e])=>e));var w={autosize:!0,xaxis:{autorange:!0,scaleanchor:"y",scaleratio:1},yaxis:{autorange:"reversed"},plot_bgcolor:n.dark.isActive?"#121212":"#fff",paper_bgcolor:n.dark.isActive?"#121212":"#fff"};o.react(t.value,[].concat(...D),w).catch((e=>{n.notify({type:"negative",message:"Failed to plot data."}),u.error(e)}))}};return(0,r.bv)((()=>{d()})),{plotContainerRef:t,updatePlot:d,highlightTypes:a}},watch:{csvData(){this.updatePlot()},highlightTypes(){this.updatePlot()}}});var f=n(74260),h=n(15151),v=n(7518),m=n.n(v);const g=(0,f.Z)(d,[["render",a]]),y=g;m()(d,"components",{QResizeObserver:h.Z})},26121:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(83673);function l(e,t,n,l,a,i){const o=(0,r.up)("q-icon"),s=(0,r.up)("q-input"),p=(0,r.up)("q-table");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(p,{title:e.title,rows:e.rows,columns:e.columns,"row-key":"uuid",filter:e.filter,selection:"multiple",selected:e.selected,"onUpdate:selected":t[1]||(t[1]=t=>e.selected=t)},{"top-right":(0,r.w5)((()=>[(0,r.Wm)(s,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filter=t),placeholder:"Search"},{append:(0,r.w5)((()=>[(0,r.Wm)(o,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["title","rows","columns","filter","selected"])])}var a=n(96601),i=n(61959),o=n(33954);const s=[{name:"x",label:"X",field:"x",format:e=>parseFloat(e).toFixed(),sortable:!0,sort:(e,t)=>parseFloat(e)-parseFloat(t)},{name:"y",label:"Y",field:"y",format:e=>parseFloat(e).toFixed(),sortable:!0,sort:(e,t)=>parseFloat(e)-parseFloat(t)},{name:"z",label:"Z",field:"z",format:e=>parseFloat(e).toFixed(),sortable:!0,sort:(e,t)=>parseFloat(e)-parseFloat(t)},{name:"type",label:"Type",field:"type",sortable:!0},{name:"display_name",label:"Display name",field:"display_name",sortable:!0}],p=(0,r.aZ)({name:"EntityContentsTable",props:{csvData:{type:String,required:!0},title:{type:String,required:!0}},watch:{selected(e){this.updateHighlight(e.map((e=>{var t;return null!==(t=e.type)&&void 0!==t?t:"unknown"})))}},setup(e){const t=(0,o.useStore)(),n=(0,i.iH)(""),l=(0,i.iH)([]),p=(0,r.Fl)((()=>(0,a.ueB)(e.csvData))),c=e=>t.commit("perfViewer/setHighlight",e);return{columns:s,filter:n,selected:l,rows:p,updateHighlight:c}}});var c=n(74260),u=n(49062),d=n(34842),f=n(24554),h=n(7518),v=n.n(h);const m=(0,c.Z)(p,[["render",l]]),g=m;v()(p,"components",{QTable:u.Z,QInput:d.Z,QIcon:f.Z})},93822:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r=n(83673);function l(e,t,n,l,a,i){const o=(0,r.up)("DropZoneComponent");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)(o,{onFileAdded:e.fileAdded},null,8,["onFileAdded"])])}var a=n(48825),i=n(33954),o=n(62323);const s=e=>((0,r.dD)("data-v-2ac088ba"),e=e(),(0,r.Cn)(),e),p=s((()=>(0,r._)("div",null,"Load file",-1)));function c(e,t,n,l,a,i){const s=(0,r.up)("q-icon"),c=(0,r.up)("q-chip");return(0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(["dropzone",{hightlight:e.hightlight,disabled:!e.enabled}]),onClick:t[1]||(t[1]=(...t)=>e.openFileSelection&&e.openFileSelection(...t)),onDragover:t[2]||(t[2]=(...t)=>e.onDragOver&&e.onDragOver(...t)),onDragleave:t[3]||(t[3]=(...t)=>e.onDragLeave&&e.onDragLeave(...t)),onDrop:t[4]||(t[4]=(...t)=>e.onDrop&&e.onDrop(...t))},[(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(s,{name:"file_upload"}),p,(0,r._)("input",{ref:"fileInput",class:"file-input",type:"file",multiple:"",onChange:t[0]||(t[0]=(...t)=>e.onFileChanged&&e.onFileChanged(...t)),accept:"application/zip"},null,544)])),_:1})],34)}var u=n(40019);const d=e=>new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})),f=(0,r.aZ)({name:"DropZone",props:{enabled:{type:Boolean,required:!1,default:!0}},data(){return{hightlight:!1,mimeTypes:["application/zip","application/x-zip","application/x-zip-compressed"]}},emits:{fileAdded(e){return!0}},methods:{onDragOver(e){this.enabled&&(e.preventDefault(),this.hightlight=!0)},onDragLeave(){this.hightlight=!1},onDrop(e){var t;if(!this.enabled)return;e.preventDefault();const n=(null===(t=e.dataTransfer)||void 0===t?void 0:t.files)||new FileList;for(var r=0;r<n.length;r++){let e=n.item(r);if(null!=e&&this.mimeTypes.includes(e.type)){d(e).then((e=>this.$emit("fileAdded",e))).catch((e=>u.error(e)));break}}this.hightlight=!1},openFileSelection(){if(!this.enabled)return;const e=this.$refs.fileInput;e.click()},onFileChanged(e){var t,n;if(e.target.files&&(null===(t=e.target.files)||void 0===t?void 0:t.length)){const t=null!==(n=e.target.files)&&void 0!==n?n:new FileList;for(var r=0;r<t.length;r++){let e=t.item(r);if(null!=e&&this.mimeTypes.includes(e.type)){d(e).then((e=>this.$emit("fileAdded",e))).catch((e=>u.error(e)));break}}}}}});var h=n(74260),v=n(67030),m=n(24554),g=n(7518),y=n.n(g);const w=(0,h.Z)(f,[["render",c],["__scopeId","data-v-2ac088ba"]]),b=w;y()(f,"components",{QChip:v.Z,QIcon:m.Z});var D=n(40019),F=function(e,t,n,r){function l(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function i(e){try{s(r.next(e))}catch(t){a(t)}}function o(e){try{s(r["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):l(e.value).then(i,o)}s((r=r.apply(e,t||[])).next())}))};const Z=(0,r.aZ)({name:"PerfZipSelector",setup(){const e=(0,i.useStore)(),t=(0,a.Z)(),n=function(n){return F(this,void 0,void 0,(function*(){try{yield e.dispatch("perfViewer/setPerfFileContents",n)}catch(r){D.error(r),t.notify({type:"negative",message:"Failed to load zip file."})}}))};return{fileAdded:n}},components:{DropZoneComponent:b}}),x=(0,h.Z)(Z,[["render",l]]),_=x},48770:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(83673);const l=(0,r._)("div",{class:"text-h6"},"Profiling report",-1);function a(e,t,n,a,i,o){const s=(0,r.up)("q-card-section"),p=(0,r.up)("q-hierarchy"),c=(0,r.up)("q-card");return(0,r.wg)(),(0,r.j4)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[l])),_:1}),(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[(0,r.Wm)(p,{columns:e.columns,data:e.nodes},null,8,["columns","data"])])),_:1})])),_:1})}var i=n(61959);const o=/(?:^\[(\d+)\][ |]*(#\w+) (\d+)\/(\d+)$)|(?:^\[(\d+)\][ |]*([^(]+)\((\d+)\/(\d+)\) - ([\d.]+)%\/([\d.]+)%$)/,s=/--- BEGIN PROFILE DUMP ---/,p=/--- END PROFILE DUMP ---/;class c{constructor(e){this.root=new u,this.parseProfileReport(e)}parseProfileReport(e){var t;const n=e.split(/\r?\n/);let r=this.root,l=this.root,a=0,i=!1;for(const c of n){if(!i){if(!s.exec(c))continue;i=!0;continue}if(p.exec(c))break;let e;if(null!=(e=o.exec(c))){const n=parseInt(null!==(t=e[1])&&void 0!==t?t:e[5],10);if(n<a)while(n<=r.level&&r!=this.root)r=r.parent;else n>a&&(r=l);let i;if(a=n,e[1])i={parent:r,text:e[2],children:[],level:n,num1:parseInt(e[3]),num2:parseInt(e[4])};else{if(!e[5])continue;i={parent:r,text:e[6],children:[],level:n,num1:parseInt(e[7]),num2:parseInt(e[8]),pctParent:parseFloat(e[9]),pctTotal:parseFloat(e[10])}}r.children.push(i),l=i}}}}class u{constructor(){this.parent=this,this.level=-1,this.children=[],this.text="Profile Report"}}const d=[{name:"text",label:"event",align:"left",field:"text",sortable:!1},{name:"pctParent",label:"% of Parent",sortable:!0,field:"pctParent",align:"right"},{name:"pctTotal",label:"% of Total",sortable:!0,field:"pctTotal",align:"right"}],f=(0,r.aZ)({name:"ProfilingTreeComponent",props:{profileData:{type:String,required:!0}},computed:{nodes(){return new c(this.profileData).root.children}},setup(){const e=(0,i.iH)(""),t=(0,i.iH)(null);return{filter:e,columns:d,resetFilter(){var n;e.value="",null===(n=t.value)||void 0===n||n.focus()}}}});var h=n(74260),v=n(10151),m=n(25589),g=n(7518),y=n.n(g);const w=(0,h.Z)(f,[["render",a]]),b=w;y()(f,"components",{QCard:v.Z,QCardSection:m.Z})},52361:()=>{},94616:()=>{}}]);